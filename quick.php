
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Tivo is a HTML landing page template built with Bootstrap to help you crate engaging presentations for SaaS apps and convert visitors into users.">
    <meta name="author" content="Inovatik">

    <!-- OG Meta Tags to improve the way the post looks when you share the page on LinkedIn, Facebook, Google+ -->
	<meta property="og:site_name" content="" /> <!-- website name -->
	<meta property="og:site" content="" /> <!-- website link -->
	<meta property="og:title" content=""/> <!-- title shown in the actual shared post -->
	<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
	<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
	<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
	<meta property="og:type" content="article" />

    <!-- Website Title -->
    <title>Home - E-Voting Menggunakan E-KTP berbasis RFID</title>
    
    <!-- Styles -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap&subset=latin-ext" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/fontawesome-all.css" rel="stylesheet">
    <link href="css/swiper.css" rel="stylesheet">
	<link href="css/magnific-popup.css" rel="stylesheet">
	<link href="css/styles.css" rel="stylesheet">
	   
    <!-- Preloader -->
	<div class="spinner-wrapper">
        <div class="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
        </div>
    </div>
    <!-- end of preloader -->
    

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom fixed-top">
        <div class="container">

            <!-- Text Logo - Use this if you don't have a graphic logo -->
            <!-- <a class="navbar-brand logo-text page-scroll" href="index.html">Tivo</a> -->

            <!-- Text Logo -->
            <a class="navbar-brand logo-text page-scroll" href="index.php">E-VOTING</a>
            
            <!-- Mobile Menu Toggle Button -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-awesome fas fa-bars"></span>
                <span class="navbar-toggler-awesome fas fa-times"></span>
            </button>
            <!-- end of mobile menu toggle button -->

            <div class="collapse navbar-collapse" id="navbarsExampleDefault">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="index.php">HOME <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="quick.php">QUICK COUNT</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link page-scroll" href="#rekapitulasi">REKAPITULASI</a>
                    </li>
                </ul>
                <span class="nav-item">
                    <a class="btn-outline-sm" href="admin/">LOG IN</a>
                </span>
            </div>
        </div> <!-- end of container -->
    </nav> <!-- end of navbar -->
    <!-- end of navigation -->

    <!-- Header -->
    <header id="header" class="header">
        <div class="header-content">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-xl-5">
                        <div class="text-container">
                            <h1>Selamat Datang</h1>
                            <p class="p-large">Di Website Sistem Informasi E-Voting Menggunakan E-KTP</p>
                        </div> <!-- end of text-container -->
                    </div> <!-- end of col -->
                    <div class="col-lg-6 col-xl-7">
                        <div class="image-container">
                            <div class="img-wrapper">
                                <img class="img-fluid" src="images/description-3.png" alt="alternative" >
                            </div> <!-- end of img-wrapper -->
                        </div> <!-- end of image-container -->
                    </div> <!-- end of col -->
                </div> <!-- end of row -->
            </div> <!-- end of container -->
        </div> <!-- end of header-content -->
    </header> <!-- end of header -->
    <svg class="header-frame" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 1920 310"><defs><style>.cls-1{fill:#5f4def;}</style></defs><title>header-frame</title><path class="cls-1" d="M0,283.054c22.75,12.98,53.1,15.2,70.635,14.808,92.115-2.077,238.3-79.9,354.895-79.938,59.97-.019,106.17,18.059,141.58,34,47.778,21.511,47.778,21.511,90,38.938,28.418,11.731,85.344,26.169,152.992,17.971,68.127-8.255,115.933-34.963,166.492-67.393,37.467-24.032,148.6-112.008,171.753-127.963,27.951-19.26,87.771-81.155,180.71-89.341,72.016-6.343,105.479,12.388,157.434,35.467,69.73,30.976,168.93,92.28,256.514,89.405,100.992-3.315,140.276-41.7,177-64.9V0.24H0V283.054Z"/></svg>
    <!-- end of header -->
 <!-- Customers -->
 <div class="slider-1">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    
                    <!-- Image Slider -->
                    <div class="slider-container">
                        <div class="swiper-container image-slider">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                        <img class="img-fluid" src="images/luberjurdil.png" alt="alternative">
                                </div>
                                <div class="swiper-slide">
                                        <img class="img-fluid" src="images/luberjurdil.png" alt="alternative">
                                </div>
                                <div class="swiper-slide">
                                        <img class="img-fluid" src="images/luberjurdil.png" alt="alternative">
                                </div>
                                <div class="swiper-slide">
                                        <img class="img-fluid" src="images/luberjurdil.png" alt="alternative">
                                </div>
                                <div class="swiper-slide">
                                        <img class="img-fluid" src="images/luberjurdil.png" alt="alternative">
                                </div>
                            </div> <!-- end of swiper-wrapper -->
                        </div> <!-- end of swiper container -->
                    </div> <!-- end of slider-container -->
                    <!-- end of image slider -->

                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of slider-1 -->
    <!-- end of customers -->


    <div class="cards-1">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
   <canvas id="canvas"></canvas>
</div>
</div>
</div>
</div>


<?php 

include('include/connection.php');

// menghitung perolehan suara

   $thn = date('Y');
   $dpn = date('Y') + 1;
   $periode = $thn . '/' . $dpn;
   $kan = $con->prepare("SELECT k.id_kandidat AS id_kandidat, nama_calon, foto, visi, misi, COUNT(su.id_kandidat) AS suara, k.periode AS periode FROM t_kandidat k LEFT JOIN t_suara su ON(k.id_kandidat = su.id_kandidat) WHERE k.periode = ? GROUP BY k.id_kandidat") or die($con->error);
   $kan->bind_param('s', $periode);
   $kan->execute();
   $kan->store_result();
   $numb = $kan->num_rows();
   $label = '';
   $data = '';
   for ($i = 1; $i <= $numb; $i++) {
      $kan->bind_result($id, $nama, $foto, $visi, $misi, $suara, $kandidat);
      $kan->fetch();
      $label .= " " .$suara. "," ;

   }
   $labels = trim($label, '');

   
   $user = mysqli_query($con,"SELECT * FROM t_user k, t_suara s where s.nis =k.id_user");
   $userss = mysqli_num_rows($user);
   // mengambil data barang
   $data_barang = mysqli_query($con,"SELECT * FROM t_user");
   // menghitung data barang
   $jumlah_barang = mysqli_num_rows($data_barang);

   $umlha=$jumlah_barang-$userss;

?>

<p>Jumlah Pemilih : <b><?php echo $jumlah_barang; ?></b></p>

<p>Jumlah Belum  Memilih : <b><?php echo $jumlah_barang-$userss; ?></b></p>

<script type="text/javascript" src="assets/js/jquery.js"></script>
<script type="text/javascript" src="assets/js/foundation.js"></script>
<script type="text/javascript" src="assets/js/docs.js"></script>
   <script type="text/javascript" src="assets/js/chart-bundle.js"></script>
   <script type="text/javascript" src="assets/js/utils.js"></script>
   <script type="text/javascript" src="assets/js/FileSaver.min.js"></script>
   <script type="text/javascript" src="assets/js/canvas-toBlob.js"></script>

<script type="text/javascript">
   // slideToggle()
   $(document).ready(function() {
      $(".dropdown-toggle").click(function() {
         $(this).parent().find(".dropdown-menu").slideToggle();
      });
      $("#menu-toggle").click(function() {
         $(this).parent().find(".menu").slideToggle();
      });
   });

   $("#save-img").click(function() {
      $('#canvas').get(0).toBlob(function(blob) {
         saveAs(blob, 'chart.png');
      });
   });

      function tampil() {
         $.ajax({
            url: 'ajax.php',
            method: "GET",
            success: function(data) {
               $('#data').html(data);
            }
         });
      }

      $(document).ready(function() {
         $('#periode').change(function() {
            var periode = $('#periode').val();

            $.ajax({
               url: "ajax.php",
               method: "POST",
               data: {
                  periode: periode
               },
               success: function(data) {
                  $('#data').html(data);
               }
            });
         });
      });

      window.onload = function() {
         tampil();
      };

   <?php
   sleep(1);
   $user = mysqli_query($con,"SELECT * FROM t_suara");
   $suara = mysqli_num_rows($user);

      $thn = date('Y');
      $dpn = date('Y') + 1;
      $periode = $thn . '/' . $dpn;
      $kan = $con->prepare("SELECT k.id_kandidat AS id_kandidat, nama_calon, foto, visi, misi, COUNT(su.id_kandidat) AS suara, k.periode AS periode FROM t_kandidat k LEFT JOIN t_suara su ON(k.id_kandidat = su.id_kandidat) WHERE k.periode = ? GROUP BY k.id_kandidat") or die($con->error);
      $kan->bind_param('s', $periode);
      $kan->execute();
      $kan->store_result();
      $numb = $kan->num_rows();
      $label = '';
      $data = '';
      for ($i = 1; $i <= $numb; $i++) {
         $kan->bind_result($id, $nama, $foto, $visi, $misi, $suara, $kandidat);
         $kan->fetch();
         $label .= "'" . $nama . "',";
         $data .= $suara . ',';
      }
      $labels = trim($label, ',');
      $datas  = trim($data, ',');
      ?>
      
      var chartData = {
         labels: [
            <?php
          
            echo $labels;
            ?>
         ],
         datasets: [{
            type: 'bar',
            label: 'Suara Masuk : ',
            borderColor: window.chartColors.green,
            backgroundColor: [
               window.chartColors.blue,
               window.chartColors.red,
               window.chartColors.green,
               
            ],
            borderWidth: 2,
            fill: false,
            data: [
               <?php
               echo $datas;
               ?>
            ]
         }],

      };
      window.onload = function() {
         var ctx = document.getElementById("canvas").getContext("2d");
         window.myMixedChart = new Chart(ctx, {
            type: 'bar',
            name: 'Browser share',
            data: chartData,
            options: {
               responsive: true,
               title: {
                  display: true,
                  text: 'Perolehan Suara : ',
                  fontSize: 40
               },
               legend: {
                  $labels: {
                     fontSize: 20
                  }
               },
               scales: {
                  xAxes: [{
                     ticks: {
                        fontSize: 15
                     }
                  }],
                  yAxes: [{
                     ticks: {
                        fontSize: 15,
                        min: 0
                     }
                  }]
               }
            }
         });
      };
   <?php

?>

</script>

    <!-- Footer -->
    <div class="copyright">
        <div class="container" width="100 px">
            <div class="row">
                <div class="col-lg-12">
                    <p class="p-small">Copyright © E-Voting 2022</p>
                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of Footer --> 
    <!-- end of Footer -->
    
    	
    <!-- Scripts -->
    <script src="js/jquery.min.js"></script> <!-- jQuery for Bootstrap's JavaScript plugins -->
    <script src="js/popper.min.js"></script> <!-- Popper tooltip library for Bootstrap -->
    <script src="js/bootstrap.min.js"></script> <!-- Bootstrap framework -->
    <script src="js/jquery.easing.min.js"></script> <!-- jQuery Easing for smooth scrolling between anchors -->
    <script src="js/swiper.min.js"></script> <!-- Swiper for image and text sliders -->
    <script src="js/jquery.magnific-popup.js"></script> <!-- Magnific Popup for lightboxes -->
    <script src="js/validator.min.js"></script> <!-- Validator.js - Bootstrap plugin that validates forms -->
    <script src="js/scripts.js"></script> <!-- Custom scripts -->

</body>
</html>